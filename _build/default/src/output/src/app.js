// Generated by Melange

import * as Caml_obj from "melange.js/caml_obj.js";
import * as Curry from "melange.js/curry.js";
import * as Tea_cmd from "melange-tea/tea_cmd.js";
import * as Tea_debug from "melange-tea/tea_debug.js";
import * as Tea_html from "melange-tea/tea_html.js";
import * as Tea_navigation from "melange-tea/tea_navigation.js";
import * as Tea_sub from "melange-tea/tea_sub.js";

function locationChanged(param_0) {
  return {
    TAG: /* LocationChanged */ 0,
    _0: param_0
  };
}

function msg_to_string(_msg) {
  return "foo";
}

function update(model, param) {
  if (/* tag */ typeof param === "number" || typeof param === "string") {
    if (param === /* AnswerCat */ 0) {
      return [
        {
          is_a_cat: true
        },
        Tea_cmd.none
      ];
    } else {
      return [
        {
          is_a_cat: false
        },
        Tea_cmd.none
      ];
    }
  } else {
    return [
      model,
      Tea_cmd.none
    ];
  }
}

function init(param, _location) {
  return [
    {
      is_a_cat: undefined
    },
    Tea_cmd.none
  ];
}

function view_button(selected, button_text, msg) {
  const colors = selected ? "text-primary-plum bg-background-lavender" : "bg-primary-plum text-background-lavender";
  return Tea_html.button(undefined, undefined, {
    hd: Tea_html.Events.onClick(msg),
    tl: {
      hd: Tea_html.Attributes.class$p("w-1/4 text-xl text-center font-body border-1 rounded-xl " + colors),
      tl: /* [] */ 0
    }
  }, {
    hd: Tea_html.text(button_text),
    tl: /* [] */ 0
  });
}

function answer_view(model) {
  const match = model.is_a_cat;
  if (match !== undefined) {
    if (match) {
      return Tea_html.div(undefined, undefined, /* [] */ 0, {
        hd: Tea_html.text("Miaou"),
        tl: /* [] */ 0
      });
    } else {
      return Tea_html.div(undefined, undefined, /* [] */ 0, {
        hd: Tea_html.text("Dommage, bon courage !"),
        tl: /* [] */ 0
      });
    }
  } else {
    return Tea_html.div(undefined, undefined, /* [] */ 0, {
      hd: Tea_html.text(""),
      tl: /* [] */ 0
    });
  }
}

function view(model) {
  return Tea_html.div(undefined, undefined, {
    hd: Tea_html.Attributes.class$p("h-full bg-background-lavender m-auto"),
    tl: /* [] */ 0
  }, {
    hd: Tea_html.div(undefined, undefined, {
      hd: Tea_html.Attributes.class$p("flex flex-col justify-center"),
      tl: /* [] */ 0
    }, {
      hd: Tea_html.span(undefined, undefined, {
        hd: Tea_html.Attributes.class$p("p-20 text-4xl text-center text-primary-plum font-display font-bold"),
        tl: /* [] */ 0
      }, {
        hd: Tea_html.text("Es-tu un chat ?"),
        tl: /* [] */ 0
      }),
      tl: {
        hd: Tea_html.img(undefined, undefined, {
          hd: Tea_html.Attributes.src("/logo.png"),
          tl: {
            hd: Tea_html.Attributes.alt("cat"),
            tl: {
              hd: Tea_html.Attributes.class$p("w-1/3 m-auto"),
              tl: /* [] */ 0
            }
          }
        }, /* [] */ 0),
        tl: {
          hd: Tea_html.p(undefined, undefined, /* [] */ 0, /* [] */ 0),
          tl: /* [] */ 0
        }
      }
    }),
    tl: {
      hd: Tea_html.div(undefined, undefined, {
        hd: Tea_html.Attributes.class$p("flex flex-row justify-center gap-10 "),
        tl: /* [] */ 0
      }, {
        hd: view_button(Caml_obj.caml_equal(model.is_a_cat, true), "Oui", /* AnswerCat */ 0),
        tl: {
          hd: view_button(Caml_obj.caml_equal(model.is_a_cat, false), "Non", /* AnswerNotCat */ 1),
          tl: /* [] */ 0
        }
      }),
      tl: {
        hd: Tea_html.div(undefined, undefined, {
          hd: Tea_html.Attributes.class$p("flex flex-col justify-center text-center p-20 text-4xl text-primary-plum font-bold"),
          tl: /* [] */ 0
        }, {
          hd: answer_view(model),
          tl: /* [] */ 0
        }),
        tl: /* [] */ 0
      }
    }
  });
}

function subscriptions(_model) {
  return Tea_sub.none;
}

function shutdown(_model) {
  return Tea_cmd.none;
}

function start_app(container) {
  return Tea_navigation.navigationProgram(locationChanged, {
    init: init,
    update: update,
    view: view,
    subscriptions: subscriptions,
    shutdown: shutdown
  })(container, undefined);
}

function start_debug_app(initOpt, shutdownOpt, container) {
  const init$1 = initOpt !== undefined ? initOpt : init;
  const shutdown$1 = shutdownOpt !== undefined ? shutdownOpt : shutdown;
  return Tea_debug.navigationProgram(locationChanged, {
    init: init$1,
    update: update,
    view: view,
    subscriptions: subscriptions,
    shutdown: shutdown$1
  }, msg_to_string, container, undefined);
}

function start_hot_debug_app(container, cachedModel) {
  const modelRef = {
    contents: undefined
  };
  const shutdown = function (model) {
    modelRef.contents = model;
    return Tea_cmd.none;
  };
  const init$1 = cachedModel !== undefined ? (function (flags, $$location) {
      return [
        cachedModel,
        Tea_cmd.none
      ];
    }) : init;
  const app = start_debug_app(init$1, shutdown, container);
  const oldShutdown = app.shutdown;
  const newShutdown = function (param) {
    Curry._1(oldShutdown, undefined);
    return modelRef.contents;
  };
  Object.assign(app, {
    shutdown: newShutdown
  });
  return newShutdown;
}

const answerCat = /* AnswerCat */ 0;

const answerNotCat = /* AnswerNotCat */ 1;

export {
  answerCat,
  answerNotCat,
  locationChanged,
  msg_to_string,
  update,
  init,
  view_button,
  answer_view,
  view,
  subscriptions,
  shutdown,
  start_app,
  start_debug_app,
  start_hot_debug_app,
}
/* Tea_cmd Not a pure module */
